# flake8: noqa
from crunch.skeleton.measurements.fatigue import fatigue
import numpy as np


tol = 1e-6


def test_fatigue():
    test_array = [
        [
            (650.9971, 153.32529),
            (660.7415, 227.72816),
            (609.79956, 229.71353),
            (570.58374, 304.11322),
            (525.6227, 357.03714),
            (709.6511, 225.85246),
            (758.71704, 288.56598),
            (836.9691, 315.92368),
            (698.02924, 380.5211),
            (664.6637, 388.3969),
            (682.2982, 511.88223),
            (698.0374, 674.44324),
            (737.0972, 366.8476),
            (823.42804, 464.84744),
            (915.408, 649.01996),
            (639.1548, 147.50786),
            (664.63184, 147.34082),
            (629.33325, 167.0538),
            (682.2562, 159.19675),
            (978.0399, 680.3069),
            (978.1099, 672.4647),
            (913.41425, 664.6381),
            (703.8121, 697.86273),
            (684.28467, 696.03864),
            (709.69214, 682.30054),
        ],
        [
            (651.0108, 153.34796),
            (658.76587, 227.74791),
            (607.815, 229.72922),
            (570.567, 304.12866),
            (525.6024, 357.0577),
            (709.63245, 225.87619),
            (760.5705, 288.53952),
            (835.0927, 315.91223),
            (697.9631, 378.64047),
            (664.61444, 386.49805),
            (682.23987, 519.6815),
            (699.93805, 680.3088),
            (735.1389, 366.8329),
            (823.41254, 468.71802),
            (915.4466, 648.9206),
            (641.1041, 147.49216),
            (664.6412, 147.39986),
            (627.44226, 165.03217),
            (682.23596, 159.21967),
            (976.173, 680.376),
            (978.15857, 672.4517),
            (913.4562, 664.5995),
            (705.7691, 697.9409),
            (688.18353, 697.96844),
            (709.6911, 686.17566),
        ],
    ]
    estimated = fatigue(test_array)
    exact0 = 75673.873535
    assert np.abs(round(estimated, 6) - exact0) < tol
